# =========================================================
# Sonowand C++ VideoGrabber Unit Tests 
# =========================================================

# =========================================================
# list of all test units
QT4_WRAP_CPP( VG_TEST_SOURCE_FILES 
    vgTestVideoGrabber.h)
set(VG_TEST_SOURCE_FILES
	vgTestVideoGrabber.cpp
    ${VG_TEST_SOURCE_FILES}
    ) 

# =========================================================
# create a pure cppunit app for debugging. Not added to ctest.
add_executable(testVideoGrabber
    ../../Integration/SharedTestMain.cpp
    ${VG_TEST_SOURCE_FILES}
    )
target_link_libraries(testVideoGrabber snwVideoGrabber cppunit)
set_target_properties(testVideoGrabber PROPERTIES LINK_FLAGS "${SNW_LINK_FLAGS} ${GRABLINKFLAGS}" COMPILE_FLAGS "${SNW_TEST_FLAGS} ${GRABCFLAGS}")
# =========================================================

# =========================================================
# -- CppUnit - CTest integration. ---------------
# --   Use CISST_ADD_TESTS() to convert each CppUnit test to a CTest test. 

# Initialize cisst routines
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${SSC_SOURCE_DIR}/Testing/cisst_code)
include(cisstMacros)

# link all CppUnit tests to the cisstTestsMain library
add_executable(testVideoGrabber_CppUnit_CTest ${VG_TEST_SOURCE_FILES} )
target_link_libraries(testVideoGrabber_CppUnit_CTest snwVideoGrabber cisstTestsMain cppunit )
set_target_properties(testVideoGrabber_CppUnit_CTest PROPERTIES LINK_FLAGS "${SNW_LINK_FLAGS} ${GRABLINKFLAGS}" COMPILE_FLAGS "${SNW_TEST_FLAGS} ${GRABCFLAGS}")
# Generate a CTest list of tests
CISST_ADD_TESTS(testVideoGrabber_CppUnit_CTest)

# -- finished CppUnit - CTest integration. ------
# =========================================================
